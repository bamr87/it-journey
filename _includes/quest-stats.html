{% comment %}
Quest Statistics Display Component
Displays statistics for quests, optionally filtered by level.

Parameters:
  level - (optional) Filter quests by level prefix (e.g., "1100")
{% endcomment %}

{% assign all_quests = site.quests | where_exp: "q", "q.fmContentType == 'quest'" %}

{% if include.level %}
  {% assign display_quests = all_quests | where_exp: "q", "q.level contains include.level" %}
  {% assign stats_title = "Level " | append: include.level | append: " Statistics" %}
{% else %}
  {% assign display_quests = all_quests %}
  {% assign stats_title = "Quest Collection Statistics" %}
{% endif %}

{% assign total_count = display_quests | size %}
{% assign main_quests = display_quests | where: "quest_type", "main_quest" | size %}
{% assign side_quests = display_quests | where: "quest_type", "side_quest" | size %}
{% assign bonus_quests = display_quests | where: "quest_type", "bonus_quest" | size %}
{% assign epic_quests = display_quests | where: "quest_type", "epic_quest" | size %}

{% assign easy_quests = display_quests | where_exp: "q", "q.difficulty contains 'Easy'" | size %}
{% assign medium_quests = display_quests | where_exp: "q", "q.difficulty contains 'Medium'" | size %}
{% assign hard_quests = display_quests | where_exp: "q", "q.difficulty contains 'Hard'" | size %}
{% assign epic_difficulty = display_quests | where_exp: "q", "q.difficulty contains 'Epic'" | size %}

<div class="quest-stats-container">
  <h3>ğŸ“Š {{ stats_title }}</h3>
  
  <div class="quest-stats-grid">
    <!-- Total Count -->
    <div class="stat-card stat-total">
      <div class="stat-icon">ğŸ“š</div>
      <div class="stat-value">{{ total_count }}</div>
      <div class="stat-label">Total Quests</div>
    </div>
    
    <!-- Quest Types -->
    <div class="stat-card stat-types">
      <div class="stat-icon">ğŸ·ï¸</div>
      <div class="stat-breakdown">
        <div class="stat-item">ğŸ° Main: <strong>{{ main_quests }}</strong></div>
        <div class="stat-item">âš”ï¸ Side: <strong>{{ side_quests }}</strong></div>
        <div class="stat-item">ğŸ Bonus: <strong>{{ bonus_quests }}</strong></div>
        <div class="stat-item">ğŸ‘‘ Epic: <strong>{{ epic_quests }}</strong></div>
      </div>
      <div class="stat-label">By Type</div>
    </div>
    
    <!-- Difficulty Distribution -->
    <div class="stat-card stat-difficulty">
      <div class="stat-icon">âš¡</div>
      <div class="stat-breakdown">
        <div class="stat-item">ğŸŸ¢ Easy: <strong>{{ easy_quests }}</strong></div>
        <div class="stat-item">ğŸŸ¡ Medium: <strong>{{ medium_quests }}</strong></div>
        <div class="stat-item">ğŸ”´ Hard: <strong>{{ hard_quests }}</strong></div>
        <div class="stat-item">âš”ï¸ Epic: <strong>{{ epic_difficulty }}</strong></div>
      </div>
      <div class="stat-label">By Difficulty</div>
    </div>
  </div>
</div>

<style>
.quest-stats-container {
  margin: 1.5rem 0;
  padding: 1rem;
  background: var(--bs-tertiary-bg, #f8f9fa);
  border-radius: 0.5rem;
  border: 1px solid var(--bs-border-color, #dee2e6);
}

.quest-stats-container h3 {
  margin-bottom: 1rem;
  font-size: 1.25rem;
  color: var(--bs-heading-color, inherit);
}

.quest-stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.stat-card {
  background: var(--bs-body-bg, #fff);
  border-radius: 0.5rem;
  padding: 1rem;
  text-align: center;
  border: 1px solid var(--bs-border-color, #dee2e6);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.stat-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.stat-icon {
  font-size: 2rem;
  margin-bottom: 0.5rem;
}

.stat-value {
  font-size: 2.5rem;
  font-weight: bold;
  color: var(--bs-primary, #0d6efd);
}

.stat-label {
  font-size: 0.875rem;
  color: var(--bs-secondary-color, #6c757d);
  margin-top: 0.5rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.stat-breakdown {
  text-align: left;
  padding: 0.5rem;
}

.stat-item {
  padding: 0.25rem 0;
  font-size: 0.9rem;
}

.stat-item strong {
  color: var(--bs-emphasis-color, #212529);
}

@media (max-width: 768px) {
  .quest-stats-grid {
    grid-template-columns: 1fr;
  }
}
</style>
